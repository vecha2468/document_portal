(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2699:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var s=a(5155),r=a(2115);async function l(e,t){let a=localStorage.getItem("access"),s=new FormData;if(s.append("title",e),s.append("file",t),!(await fetch("".concat("http://127.0.0.1:8000","/api/documents/"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:s})).ok)throw Error("Upload failed")}function n(e){let{onUpload:t}=e,[a,n]=(0,r.useState)(null),[o,i]=(0,r.useState)(""),d=async e=>{e.preventDefault();try{await l(o,a),n(null),i(""),t()}catch(e){alert(e.message||"Upload failed")}};return(0,s.jsxs)("form",{onSubmit:d,className:"space-y-4 mb-6",children:[(0,s.jsx)("input",{className:"border p-2 w-full",type:"text",placeholder:"Document Title",value:o,onChange:e=>i(e.target.value),required:!0}),(0,s.jsx)("input",{className:"border p-2 w-full",type:"file",onChange:e=>n(e.target.files[0]),required:!0}),(0,s.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded",type:"submit",children:"Upload"})]})}var o=a(8835);async function i(e){if(!(await (0,o.t)("".concat("http://127.0.0.1:8000","/api/documents/").concat(e,"/"),{method:"DELETE"})).ok)throw Error("Delete failed")}async function d(e,t,a){let s=new FormData;t&&s.append("title",t),a&&s.append("file",a);let r=await (0,o.t)("".concat("http://127.0.0.1:8000","/api/documents/").concat(e,"/"),{method:"PUT",body:s});if(console.log(r),!r.ok)throw Error("Update failed")}function c(e){let{documents:t,onDelete:a,onUpdate:l,onSelect:n,selectedId:o}=e;localStorage.getItem("access");let[c,h]=(0,r.useState)(null),[u,x]=(0,r.useState)(""),[g,m]=(0,r.useState)(null),p=async e=>{try{await i(e),a()}catch(e){alert(e.message||"Delete failed")}},b=async e=>{try{await d(e,u,g),l(),h(null),m(null),x("")}catch(e){alert(e.message||"Update failed")}};return(0,s.jsx)("div",{className:"space-y-4 mt-4",children:t.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-4 p-4 rounded-xl shadow transition border-2 ".concat(o===e.id?"border-blue-500 bg-blue-50 dark:bg-blue-900":"border-transparent bg-white dark:bg-gray-800"," hover:border-blue-400"),children:[(0,s.jsx)("div",{onClick:()=>n(e.id),className:"flex-shrink-0 w-12 h-12 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center cursor-pointer hover:scale-105 transition",title:"Select document",children:(0,s.jsxs)("svg",{className:"w-7 h-7 text-blue-600 dark:text-blue-300",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 7V3a1 1 0 011-1h8a1 1 0 011 1v18a1 1 0 01-1 1H8a1 1 0 01-1-1v-4"}),(0,s.jsx)("rect",{width:"6",height:"8",x:"3",y:"8",rx:"1"})]})}),(0,s.jsx)("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:()=>n(e.id),children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-semibold text-lg truncate ".concat(o===e.id?"text-blue-700 dark:text-blue-200":"text-gray-900 dark:text-white"),children:e.title}),e.updated_at&&(0,s.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:new Date(e.updated_at).toLocaleDateString()})]})}),c===e.id?(0,s.jsxs)("div",{className:"flex flex-col gap-2 w-56",children:[(0,s.jsx)("input",{className:"w-full p-2 border rounded",type:"text",placeholder:"New Title",value:u,onChange:e=>x(e.target.value)}),(0,s.jsx)("input",{className:"w-full p-2 border rounded",type:"file",onChange:e=>m(e.target.files[0])}),(0,s.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,s.jsx)("button",{onClick:()=>{console.log("Save clicked for doc:",e.id,"Title:",u,"File:",g),b(e.id)},className:"flex-1 bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded",children:"Save"}),(0,s.jsx)("button",{onClick:()=>h(null),className:"flex-1 bg-gray-400 hover:bg-gray-500 text-white px-3 py-1 rounded",children:"Cancel"})]})]}):(0,s.jsxs)("div",{className:"flex gap-2 ml-2",children:[(0,s.jsxs)("button",{onClick:()=>{console.log("Edit clicked for doc:",e.id,e.title),h(e.id),x(e.title),m(null)},className:"bg-yellow-400 hover:bg-yellow-500 text-white px-3 py-1 rounded shadow",title:"Edit",children:[(0,s.jsx)("svg",{className:"w-5 h-5 inline-block",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536M9 13l6-6m2 2l-6 6m2-2l-6 6m2-2l-6 6"})}),(0,s.jsx)("span",{className:"ml-1",children:"Edit"})]}),(0,s.jsxs)("button",{onClick:()=>p(e.id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded shadow",title:"Delete",children:[(0,s.jsx)("svg",{className:"w-5 h-5 inline-block",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),(0,s.jsx)("span",{className:"ml-1",children:"Delete"})]})]})]},e.id))})}async function h(e,t){let a=await (0,o.t)("".concat("http://127.0.0.1:8000","/api/documents/").concat(e,"/ask/"),{method:"POST",body:JSON.stringify({question:t}),headers:{"Content-Type":"application/json"}}),s=await a.json();if(!a.ok)throw Error(s.error||"AI failed");return s.answer}function u(e){let{selectedDocId:t}=e,[a,l]=(0,r.useState)(""),[n,o]=(0,r.useState)(""),[i,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(""),x=async()=>{d(!0),u(""),o("");try{let e=await h(t,a);o(e)}catch(e){u(e.message||"Failed to get answer")}finally{d(!1)}};return(0,s.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,s.jsx)("input",{className:"border p-2 w-full rounded",placeholder:"Ask a question about the document",value:a,onChange:e=>l(e.target.value),disabled:i}),(0,s.jsx)("button",{onClick:x,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded",disabled:i||!a.trim(),children:i?"Asking...":"Ask"}),c&&(0,s.jsx)("div",{className:"text-red-600 bg-red-50 p-2 rounded",children:c}),n&&(0,s.jsxs)("div",{className:"bg-white text-black p-4 rounded shadow mt-4",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-800",children:"AI Answer:"}),(0,s.jsx)("p",{className:"mt-2",children:n})]})]})}var x=a(4614),g=a(5695);function m(){let[e,t]=(0,r.useState)(null),[l,o]=(0,r.useState)(!1),[i,d]=(0,r.useState)([]),[h,m]=(0,r.useState)(!0),p=(0,g.useRouter)();return(0,r.useEffect)(()=>{Promise.resolve().then(a.bind(a,3437)).then(e=>{let{default:t}=e,{documents:a,loading:s,refetch:r}=t();d(a),m(s)})},[]),(0,s.jsxs)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex flex-col",children:[(0,s.jsx)(x.A,{}),(0,s.jsxs)("div",{className:"flex flex-1",children:[(0,s.jsxs)("aside",{className:"hidden md:flex flex-col w-64 bg-white dark:bg-gray-800 shadow-lg p-6 space-y-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 mb-6",children:"Menu"}),(0,s.jsx)("button",{className:"w-full text-left px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition",onClick:()=>p.push("/dashboard"),children:"Dashboard Home"})]}),(0,s.jsxs)("main",{className:"flex-1 p-4 md:p-10",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Your Documents"}),(0,s.jsx)("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg shadow transition",onClick:()=>o(!0),children:"Upload Document"})]}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-xl p-6 mb-10",children:(0,s.jsx)(c,{documents:i,onDelete:refetch,onUpdate:refetch,onSelect:a=>t(e===a?null:a),selectedId:e})}),e?(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-xl p-6 mt-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:"Ask a Question"}),(0,s.jsx)(u,{selectedDocId:e})]}):(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-xl p-6 mt-6 text-center text-gray-500 dark:text-gray-300",children:(0,s.jsx)("p",{children:"Select a document to ask questions using AI."})}),l&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-40",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-xl w-full max-w-md p-8 relative animate-fade-in",children:[(0,s.jsx)("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 text-2xl font-bold focus:outline-none",onClick:()=>o(!1),"aria-label":"Close Upload Modal",children:"\xd7"}),(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"Upload Document"}),(0,s.jsx)(n,{onUpload:()=>{o(!1)}})]})})]})]})]})}a(3437)},3437:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(2115),r=a(5695),l=a(8835);function n(){(0,r.useRouter)();let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(!1),o=async()=>{n(!0);try{let e=await (0,l.t)("".concat("http://127.0.0.1:8000","/api/documents/"),{method:"GET"});if(e.ok){let a=await e.json();t(a)}else alert("Failed to fetch documents")}catch(e){alert(e.message||"Failed to fetch documents")}n(!1)};return(0,s.useEffect)(()=>{o()},[]),{documents:e,loading:a,refetch:o}}},3869:(e,t,a)=>{Promise.resolve().then(a.bind(a,2699))},4614:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(5155),r=a(5695);function l(){let e=(0,r.useRouter)(),t=localStorage.getItem("access");return(0,s.jsxs)("nav",{className:"sticky top-0 z-50 w-full backdrop-blur bg-white/80 dark:bg-gray-900/80 shadow-lg border-b border-gray-200 dark:border-gray-800 flex items-center justify-between px-4 md:px-10 py-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>e.push("/"),children:[(0,s.jsx)("span",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full bg-blue-600 text-white shadow",children:(0,s.jsxs)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 7V3a1 1 0 011-1h8a1 1 0 011 1v18a1 1 0 01-1 1H8a1 1 0 01-1-1v-4"}),(0,s.jsx)("rect",{width:"6",height:"8",x:"3",y:"8",rx:"1"})]})}),(0,s.jsx)("span",{className:"text-2xl font-bold tracking-tight text-blue-700 dark:text-blue-300",children:"DocuAI Portal"})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 md:gap-4",children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow transition",children:"Dashboard"}),(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("access"),e.push("/")},className:"px-4 py-2 rounded-lg bg-red-500 hover:bg-red-600 text-white font-semibold shadow transition",children:"Logout"}),(0,s.jsx)("span",{className:"ml-2 hidden md:inline-flex items-center justify-center w-9 h-9 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300",children:(0,s.jsxs)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{cx:"12",cy:"8",r:"4"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 20c0-2.21 3.58-4 8-4s8 1.79 8 4"})]})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>e.push("/login"),className:"px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white font-semibold shadow transition",children:"Login"}),(0,s.jsx)("button",{onClick:()=>e.push("/signup"),className:"px-4 py-2 rounded-lg bg-green-500 hover:bg-green-600 text-white font-semibold shadow transition",children:"Sign Up"})]})})]})}},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},8835:(e,t,a)=>{"use strict";async function s(){let e=localStorage.getItem("refresh"),t=await fetch("".concat("http://127.0.0.1:8000","/api/users/token/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})}),a=await t.json();if(!t.ok)throw Error(a.detail||"Refresh token failed");return localStorage.setItem("access",a.access),a.access}async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=localStorage.getItem("access"),r=t.body instanceof FormData;t.headers={...t.headers||{},Authorization:"Bearer ".concat(a),...r?{}:{"Content-Type":t.headers&&t.headers["Content-Type"]?t.headers["Content-Type"]:"application/json"}};let l=await fetch(e,t);if(401===l.status)try{a=await s(),t.headers.Authorization="Bearer ".concat(a),l=await fetch(e,t)}catch(e){throw localStorage.removeItem("access"),localStorage.removeItem("refresh"),window.location.href="/login",Error("Session expired. Please log in again.")}return l}a.d(t,{t:()=>r})}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(3869)),_N_E=e.O()}]);